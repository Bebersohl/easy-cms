extends layout
include ./mixins.pug
block content
  if collectionIsEmpty
    .flex.w-100.justify-center.items-center.flex-column
      p no #{collectionName}
      a(href=`/cms/${collectionName}/create`) create
  else
    .flex.items-baseline
      h3 #{collectionCount} #{collectionName}
      if collectionCount > 100
        p.ml3 Showing #{fromIndex} to #{toIndex}
          each page in pages 
            if page === query.index
              p.ml2= page.text
            else
              a.ml2(href=`?search=${query.search}&order=${query.order}&orderBy=${query.orderBy}&index=${page.offset}`)= page.text
    .flex
      form
        input(name="search" placeholder="search" value=query.search)
        input(type="hidden" name="order" value=query.order || '1')
        input(type="hidden" name="orderBy" value=query.orderBy)
        input(type="hidden" name="index" value=query.index)
        button Search
      button Download
      a(href=`/cms/${collectionName}/create`) Create #{modelName}
    if docs.length === 0 
      .flex.w-100.justify-center.items-center.flex-column
        p no #{collectionName} found
    else
      table.w-100.pv3.dt--fixed
        colgroup
          each field, index in fields
            col
        thead
          tr
            each field in fields
              th.fw5.bb.b--black-20.tl.pb3.pr3.bg-white
                - const order = query.order === '1' && query.orderBy === field.name ? '-1' : '1'
                a(href=`?search=${query.search}&order=${order}&orderBy=${field.name}&index=${query.index}`)
                  | #{field.title}
                  if query.orderBy === field.name
                    if order === '1'
                      i.fas.fa-sort-down
                    else
                      i.fas.fa-sort-up
        tbody.lh-copy
          each doc in docs
            tr
              each field in fields
                td.pv3.pr3.bb.b--black-20.truncate.mw-100= doc[field.name]
